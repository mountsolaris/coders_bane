<!DOCTYPE html>
<!--suppress ALL -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
</head>
<body>
<form id="loginForm">
    <label for="username">Enter Username</label>
    <input type="password" id="username" required/>
    <label for="password">Enter Password</label>
    <input type="text" id="password" required/>

    <label for="reasonToEnter">Please specify why you want to login. Select exactly five reasons. Don't cheat.</label>
    <select id="reasonToEnter" multiple size="2">
        <option>This doesn't work!</option>
    </select>
<!--    <button type="button" onclick="validateSelection()">Submit</button>-->
    <p id="output"></p>
    <label for="loginDate">When do you want to log in?</label>
    <div id="loginDateGiven"><input type="datetime-local" id="loginDate" required/></div>

    <label for="logoutDate">When do you want to log out?</label>
    <input type="datetime-local" id="logoutDate" required/>

    <p>What do you identify as?</p>
    <input type="radio" id="robot" name="identify" required>
    <label for="robot">Robot (beep/beep)</label>
    <input type="radio" id="human" name="identify" required>
    <label for="humanoid">Humanoid (he/her)</label>
    <input type="radio" id="insecure" name="identify" required>
    <label for="insecure">Something fluid</label>
    <input type="radio" id="consider" name="identify" required>
    <label for="consider">I need to reconsider my humanity</label>

    <input type="text" id="questionBack" size="50" required/>
    <label for="questionBack">Before we continue, do you have any questions?</label>

    <p>Now let's make sure that you're a human.</p>
    <input type="checkbox" id="inhumane" required/>
    <label for="inhumane">I am a human.</label>

    <button id="submit">Absenden</button>
</form>

<script>

    // ---- FORM BEHAVIOUR ---- //

    const loginForm = document.getElementById('loginForm');
    loginForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const loginDate = document.getElementById('loginDate');
        const user = document.getElementById('username');

        if (validateSelection()) {
            console.log('Hey ' + user.value + '! CU on ' + loginDate.value.slice(0, 10));
        }
    });

    // ---- FETCH OPTIONS ---- //

    // Pfad zur TXT-Datei
    const txtFilePath = 'options.txt';

    // Element, in das der Inhalt eingefügt werden soll
    const reasonToEnter = document.getElementById('reasonToEnter');

    // Lade die TXT-Datei
    fetch(txtFilePath)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP-Fehler! Status: ${response.status}`);
            }
            return response.text(); // Inhalt der Datei als Text
        })
        .then(text => {
            // Füge den Text in das HTML-Element ein
            reasonToEnter.innerHTML = text;
        })
        .catch(error => {
            console.error('Fehler beim Laden der Datei:', error);
        });


    // ---- MAKE SURE DROPDOWN ELEMENTS TRUE ---- //

    function validateSelection() {
        const select = document.getElementById("reasonToEnter");
        const selectedOptions = Array.from(select.selectedOptions); // Get all selected options
        const numberOfSelected = selectedOptions.length;

        if (numberOfSelected === 5) {
            // document.getElementById("output").textContent = 'Thank you.'
            return true;
        } else if (numberOfSelected < 3) {
            document.getElementById("output").textContent =
                `You need to select exactly five options. You selected only ${numberOfSelected}.`;
            return false;
        } else {
            document.getElementById("output").textContent =
                `Too many selections! You chose ${numberOfSelected}, but only five are allowed.`;
            return false;
        }
    }

    // ---- FUNCTION FOR QUESTION BACK ---- //

    const questionBack = document.getElementById('questionBack');
    const targetQuestion = 'Please tell me when this mental horrorshow will be over!'
    let stringIndex = 0;
    questionBack.addEventListener('keydown', (e) => {
        e.preventDefault();
        if (stringIndex < targetQuestion.length) {
            questionBack.value += targetQuestion[stringIndex];
            stringIndex++;
        }
    });


    // ---- DATE AND TIME ---- //


    const loginDate = document.getElementById('loginDate');
    const logoutDate = document.getElementById('logoutDate');

    const futureLoginTimeMinimum = new Date(Date.now() + 1000 * 3600 * 24);
    const futureLoginTimeMaximum = new Date(futureLoginTimeMinimum.getTime() + 1000 * 3600 * 72);

    const futureLogoutTimeMinimum = new Date(futureLoginTimeMaximum.getTime() + 1000 * 3600);
    const futureLogoutTimeMaximum = new Date(futureLogoutTimeMinimum.getTime() + 1000 * 3600 * 24);

    console.log(futureLoginTimeMinimum + futureLoginTimeMaximum);
    console.log(futureLogoutTimeMinimum + futureLogoutTimeMaximum);

    loginDate.min = futureLoginTimeMinimum.toISOString().slice(0, 16);
    loginDate.max = futureLoginTimeMaximum.toISOString().slice(0, 16);
    logoutDate.min = futureLogoutTimeMinimum.toISOString().slice(0, 16);
    logoutDate.max = futureLogoutTimeMaximum.toISOString().slice(0, 16);


</script>
</body>
</html>